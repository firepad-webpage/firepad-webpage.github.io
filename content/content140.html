<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excerpt</title>
</head>
<body>
    <h2>Excerpt</h2>
    <p>RDMA NICs desire an accurate, scalable, and fast rate limiter.</p><p>Specifically, RNICs expect the rate limiter to be accurate and scalable to precisely execute policies such as congestion control and traffic isolation, enforcing a specific rate on each flow and injecting inter-packet gaps for smoother traffic, across tens of thousands of flows at end hosts.</p><p>In addition, RNICs require the rate limiter to sustain high packet rate to ensure its integration into the data path does not degrade the throughput of RNICs.</p><p>Prior works SENIC and PIEO can achieve accuracy and scalability, but they are not fast enough.</p><p>The root cause of their performance issue is that they follow a monolithic design, directly applying rate limiting to the flows to be scheduled, and consequently transmit only one packet after sorting all flows.</p><p>Sorting a large number of flows is slow.</p><p>We present Tassel, a hierarchical rate limiter for RDMA NICs that can deliver high packet rate by enabling the transmission of multiple packets after sorting all flows.</p><p>At its core, Tassel renovates the workflow of the rate limiter hierarchically: by first applying scalable rate limiting to the flows to be scheduled, followed by accurate rate limiting to the packets to be transmitted.</p><p>Tassel leverages adaptive batching, which fetches multiple packets from scheduled flows to hide PCIe and sorting latency.</p><p>It employs packet filtering, which reduces the number of packets requiring sorting to increase the sorting rate.</p><p>Tassel can achieve 125Mpps packet rate when supporting 16K flows, making it sufficient to transmit 100 B packets at 100Gbps link rate, outperforming SENIC and PIEO by 3.6×.</p><p>Tassel demonstrates its high scalability with low resource usage.</p><p>When supporting 16K flows, the computing and memory resources consume less than 5% and 1% of our FPGA, respectively.</p><p>Tassel preserves high accuracy as it precisely enforces the rate limits ranging from 100Kbps to 100Gbps and proportionally shares bandwidth when the link is oversubscribed.</p><p>RNICs incorporate the congestion control mechanisms to manage complex environments and address challenges such as high link rate, low fabric latency, large infrastructure scale, and incast.</p><p>Within RNIC, the congestion control module computes the sending rate for potentially tens of thousands of flows, and then utilizes the rate limiter to execute these policies.</p><p>Rate-based congestion control requires the rate limiter to enforce the calculated rate for each flow and pace the traffic accordingly.</p><p>Window-based congestion control needs the rate limiter to pace packets especially when setting the congestion window smaller than one to handle the large-scale incast.</p><p>Centralized congestion control uses a centralized network arbiter to allocate bandwidth for individual senders according to the traffic pattern.</p><p>The rate limiter is also a necessary component of programmable congestion control frameworks.</p><p>The rate limiter can additionally be used to implement native hardware rate limiting for network traffic isolation.</p><p>Using the rate limiter to implement native hardware rate limiting can be beneficial.</p><p>The rate limiter should precisely enforce the given rate on each flow and inject inter-packet gaps to smooth the traffic.</p><p>It must support rate limiting for tens of thousands of flows at end hosts.</p><p>It should operate fast and achieve a high packet rate, ensuring its integration into RNIC’s data path does not degrade its high performance.</p><p>Effective congestion control and traffic isolation desire a highly accurate rate limiter.</p><p>An accurate rate limiter should support a wide range of rate limits for each flow and allow for fine-grained adjustments.</p><p>RNICs need to integrate the rate limiter into their data path.</p><p>Consequently, the performance of the rate limiter directly impacts the performance of RNIC.</p><p>WF2Q+ is an accurate and classic time-based rate limiting algorithm, widely adopted in rate limiters to ensure accuracy.</p><p>SENIC optimizes memory usage by storing just flow metadata in hardware.</p><p>PIEO saves computing resources by implementing a two-dimensional compare-and-shift architecture.</p><p>SE-PIEO, which integrates SENIC and PIEO, achieves high accuracy and scalability, but only 34.5Mpps at 16K flows—31.4% of RNIC’s capability.</p><p>It transmits one packet per sorting, and the sorting performance determines the rate limiter’s performance.</p><p>The increasing number of flows to be sorted increases the complexity of combinational circuit, which then naturally decreases the maximum achievable clock frequency.</p><p>Instead of transmitting only the head packet, we seek to transmit multiple packets after sorting all flows.</p><p>The workflow of monolithic rate limiting consists of two steps, flow-level scheduling and packet-level transmission.</p><p>We first sort flows and schedule the nearest flow.</p><p>Once a flow is scheduled, we fetch multiple packets.</p><p>Then, we apply rate limiting to this batch of fetched packets to ensure accuracy.</p><p>This extra tier of rate limiting ensures the accuracy of packet transmission and injects inter-packet gaps.</p><p>We call this packet-level rate limiting.</p><p>To bound the packet number for packet-level rate limiting, Tassel facilitates packet filtering that only filters a handful of packets that are the latest for transmission and discards the rest.</p><p>We observe that the maximum number of imminent packets in RNIC is bounded.</p><p>In RNIC with a high packet rate of 110Mpps and a scheduling latency of 1 µs, the total number of imminent packets typically amounts to a few hundred.</p><p>Packet filtering effectively reduces the number of packets that require packet-level rate limiting.</p><p>Tassel only stores the packet metadata for imminent packets.</p><p>These dropped packets can be retrieved from the host in time when this flow is scheduled again.</p><p>The overhead of this fetch-and-drop policy is low.</p><p>The packet scheduler monitors the global timer to transmit packets on time.</p><p>It supports strict rate limiting with a fallback to weighted sharing by adjusting the timing rate in the global timer.</p><p>When the aggregate flows’ rate limits are larger than the link rate, the timer proportionally slows down the system time.</p><p>Tassel’s hierarchical rate limiter can be integrated into the architecture of RNIC by replacing the original QP scheduler.</p><p>Tassel’s data path includes a flow scheduler for flow-level rate limiting and a packet scheduler for packet-level rate limiting.</p><p>Tassel uses a pipelined heap to store and sort QP scheduling time, a timing wheel for eligibility evaluation, and a register array for rank sorting.</p><p>Tassel’s memory consumption is negligible compared to 10Mb total memory size.</p><p>When supporting 10 K QPs, Tassel consumes theoretically 166.5 KB on-chip SRAM in total.</p><p>Tassel employs a combination of practical and scalable data structures to fulfill algorithm demands, save computing resources, and reduce circuit complexity.</p><p>We prototyped Tassel on an Intel Agilex FPGA board, running at a clock frequency of 250MHz.</p><p>Our FPGA board comprises 782 K ALMs, 1565 K registers, and 10464 BRAMs.</p><p>We realize 16 K QPs in Tassel and the resource consumption is broken down in Table 1.</p><p>Tassel’s implementation consumes 34.2 K ALMs, 10.1 K registers, and 115KB on-chip SRAM in total, which occupies 4.4%, 0.65%, and 0.44% available resources.</p><p>Tassel can saturate the 100Gbps link bandwidth with a 128 B message size, achieving 125Mpps high packet rate.</p><p>In contrast, SE-PIEO achieves 34.5Mpps, 27.6% as compared to Tassel.</p><p>Tassel meets RNIC’s desired high performance of 110Mpps.</p><p>Tassel achieves a high clock frequency and exhibits a slower decline in frequency as the number of flows increases.</p><p>Tassel consistently achieves line rate as the number of QPs increases.</p><p>Tassel accurately enforces any given rate limit, including both small and large rates.</p><p>Tassel maintains the accuracy of different configured rate limits with numerous flows.</p><p>Tassel supports weighted fair sharing when the link is oversubscribed.</p><p>We present the design and implementation of Tassel, a fast, scalable, and accurate rate limiter for RDMA NICs.</p><p>Tassel’s hierarchical rate limiter combines scalable flow-level rate limiting with fast and accurate packet-level rate limiting, thereby achieving high performance, scalability, and accuracy at the system level.</p>
    <h2>Original Abstract</h2> 
    <p>RDMA NICs desire a rate limiter that is accurate, scalable, and fast: to precisely enforce the policies such as congestion control and traffic isolation, to support a large number of flows, and to sustain high packet rates. Prior works such as SENIC and PIEO can achieve accuracy and scalability, but they are not fast enough, thus fail to fulfill the performance requirement of RNICs, due primarily to their monolithic design and one-packet-per-sorting transmission. We present Tassel, a hierarchical rate limiter for RDMA NICs that can deliver high packet rates by enabling multiple-packet-per-sorting transmission, while preserving accuracy and scalability. At its heart, Tassel renovates the workflow of the rate limiter hierarchically: by first applying scalable rate limiting to the flows to be scheduled, followed by accurate rate limiting to the packets to be transmitted, while leveraging adaptive batching and packet filtering to improve the performance of these two steps. We integrate Tassel into the RNIC architecture by replacing the original QP scheduler module and implement the prototype of Tassel using FPGA. Experimental results show that Tassel delivers 125 Mpps packet rate, outperforming SENIC and PIEO by 3.6×, while supporting 16 K flows with low resource usage, 7.5% - 25.6% as compared to SENIC and PIEO, and preserving high accuracy, precisely enforcing rate limits from 100 Kbps to 100 Gbps.</p>
</body>
</html>
